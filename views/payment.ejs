<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Payment</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <style>
        .payment {
            margin-top: 20px;
        }

        .payment-option {
            margin-bottom: 10px;
        }

        .payment-form {
            display: none;
        }

        .notify-server-btn {
            display: none;
            margin-top: 10px;
        }

        .payment-entry-form {
            display: none;
        }

        .confirm-payment-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Restaurant Payment</h1>
        <div class="payment">
            <div class="payment-option">
                <input type="radio" id="cash-option" name="payment-option" value="cash"
                    onchange="handlePaymentOptionChange()">
                <label for="cash-option">Cash</label>
            </div>
            <div class="payment-option">
                <input type="radio" id="credit-option" name="payment-option" value="credit"
                    onchange="handlePaymentOptionChange()">
                <label for="credit-option">Credit/Debit</label>
            </div>
            <div class="payment-form" id="cash-form">
                <button class="btn btn-primary notify-server-btn" onclick="notifyServer()">Notify Server</button>
            </div>
            <div class="payment-form" id="credit-form">
                <form>
                    <div class="form-group">
                        <label for="full-name">Full Name</label>
                        <input type="text" class="form-control" id="full-name" required>
                    </div>
                    <div class="form-group">
                        <label for="card-number">Card Number</label>
                        <input type="text" class="form-control" id="card-number" required>
                    </div>
                    <div class="form-group">
                        <label for="cvv">CVV</label>
                        <input type="text" class="form-control" id="cvv" required>
                    </div>
                    <div class="form-group">
                        <label for="expiration">Expiration</label>
                        <input type="text" class="form-control" id="expiration" required>
                    </div>
                    <div class="form-group">
                        <label for="zip-code">ZIP Code</label>
                        <input type="text" class="form-control" id="zip-code" required>
                    </div>
                </form>
            </div>
        </div>
        <button class="btn btn-success confirm-payment-btn" onclick="confirmPayment()">Confirm Payment</button>
    </div>

    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>
        function handlePaymentOptionChange() {
            var cashForm = document.getElementById('cash-form');
            var creditForm = document.getElementById('credit-form');
            var notifyServerBtn = document.getElementById('notify-server-btn');

            if (document.getElementById('cash-option').checked) {
                cashForm.style.display = 'block';
                creditForm.style.display = 'none';
                notifyServerBtn.style.display = 'block';
            } else if (document.getElementById('credit-option').checked) {
                cashForm.style.display = 'none';
                creditForm.style.display = 'block';
                notifyServerBtn.style.display = 'none';
            }
        }

        function notifyServer() {
            // Send notification to the server
            // Implement code to notify the waitstaff, using WebSocket or API call
            // Display a success message to the user
            alert('Notification sent to the server!');
        }

        function confirmPayment() {
            if (document.getElementById('cash-option').checked) {
                // Process cash payment
                // Implement code to handle cash payment

                // Redirect to the receipt page
                window.location.href = '/receipt';
            } else if (document.getElementById('credit-option').checked) {
                // Process credit/debit card payment
                // Implement code to handle credit/debit card payment
                var fullName = document.getElementById('full-name').value;
                var cardNumber = document.getElementById('card-number').value;
                var cvv = document.getElementById('cvv').value;
                var expiration = document.getElementById('expiration').value;
                var zipCode = document.getElementById('zip-code').value;

                // Make a POST request to the '/payment' route to process the payment
                fetch('/payment', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        fullName: fullName,
                        cardNumber: cardNumber,
                        cvv: cvv,
                        expiration: expiration,
                        zipCode: zipCode
                    })
                })
                    .then(response => {
                        if (response.ok) {
                            // Payment successful, redirect to the receipt page
                            window.location.href = '/receipt';
                        } else {
                            // Handle the error and display an appropriate message
                            alert('Error processing payment. Please try again.');
                        }
                    })
                    .catch(error => {
                        console.error('Error processing payment:', error);
                        // Handle the error and display an appropriate message
                        alert('Error processing payment. Please try again.');
                    });
            }
        }
    </script>
</body>

</html>