<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>DigiDiner</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
</head>

<body>
    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column text-bg-dark">
        <header class="mb-auto">
            <div>
                <nav class="nav nav-masthead justify-content-center float-md-end">
                    <a id="profileNavLink" class="nav-link fw-bold px-3" aria-current="page" href="#">Profile</a>
                    <a id="clockNavLink" class="nav-link fw-bold px-3" href="/clock">Clock</a>
                    <a id="queueNavLink" class="nav-link fw-bold px-3" href="/queue">Orders</a>
                    <a id="inventoryNavLink" class="nav-link fw-bold px-3" href="/inventory">Inventory</a>
                    <a id="floormapNavLink" class="nav-link fw-bold px-3" href="/floormap">Floor Map</a>
                </nav>
            </div>
        </header>

        <main class="px-3 d-flex flex-column h-100 align-items-center">
            <div class="col-md-4 text-center">
                <img src="images/profile.png" alt="Profile Picture" class="img-fluid rounded-circle mb-3"
                    style="width: 150px;">
            </div>
            <h1 class="text-center mt-3">Welcome, <span id="firstName"></span> <span id="lastName"></span></h1>
            <div class="text-center">
                <p class="lead">User ID: <span id="employeeId"></span></p>
                <p class="lead">Position: <span id="position"></span></p>
            </div>
            <p class="text-start position-absolute top-0 start-0 m-3">Hire Date: <span id="hireDate"></span></p>
            <p class="lead mt-4">This is your personal employee portal. Here you can find all your employee information
                such as benefits, employment paperwork, statistics, paystubs, and the employee handbook. </p>
            <p class="lead">
                <a href="#" class="btn btn-lg btn-light fw-bold border-white bg-white">Information Portal</a>
            </p>
        </main>
        <%- include('partials/footer') %>
    </div>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script>
        // Function to retrieve the signed-in employee information from the server
        async function getSignedInEmployee() {
            try {
                const response = await fetch('/api/common/employee', {
                    method: 'GET',
                    credentials: 'same-origin' // Include this option to send cookies in the request
                });

                if (response.ok) {
                    const employee = await response.json();
                    return employee;
                } else {
                    console.error('Failed to retrieve signed-in employee:', response.status);
                    return null;
                }
            } catch (error) {
                console.error('Error retrieving signed-in employee:', error);
                return null;
            }
        }

        // Function to update the session nav links' hrefs with the employee ID
        async function updateSessionNavLinks() {
            const employee = await getSignedInEmployee();
            if (employee) {
                const firstNameElement = document.getElementById('firstName');
                firstNameElement.textContent = employee.nameFirst;
                const lastNameElement = document.getElementById('lastName');
                lastNameElement.textContent = employee.nameLast;
                const employeeIdElement = document.getElementById('employeeId');
                employeeIdElement.textContent = employee.id;
                const positionElement = document.getElementById('position');
                positionElement.textContent = employee.position;
                const hireDateElement = document.getElementById('hireDate');
                hireDateElement.textContent = employee.hireDate; // Update with the appropriate property containing the timestamp
            }
        }

        // Call the function to update the session nav links
        updateSessionNavLinks();
    </script>
</body>

</body>

</html>